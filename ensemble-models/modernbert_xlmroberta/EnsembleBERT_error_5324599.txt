/usr/local/lib/python3.12/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in ModernBertForSequenceClassification is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
Running modern_bert_finetuned:   0%|          | 0/250 [00:00<?, ?it/s]/usr/local/lib64/python3.12/site-packages/torch/_inductor/compile_fx.py:236: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Running modern_bert_finetuned:   0%|          | 1/250 [00:04<18:20,  4.42s/it]Running modern_bert_finetuned:   2%|▏         | 6/250 [00:04<02:17,  1.78it/s]Running modern_bert_finetuned:   5%|▍         | 12/250 [00:04<00:56,  4.23it/s]Running modern_bert_finetuned:   7%|▋         | 17/250 [00:04<00:34,  6.84it/s]Running modern_bert_finetuned:   9%|▉         | 23/250 [00:04<00:21, 10.70it/s]Running modern_bert_finetuned:  12%|█▏        | 29/250 [00:04<00:14, 15.19it/s]Running modern_bert_finetuned:  14%|█▍        | 35/250 [00:05<00:10, 20.12it/s]Running modern_bert_finetuned:  16%|█▋        | 41/250 [00:05<00:08, 25.22it/s]Running modern_bert_finetuned:  19%|█▉        | 47/250 [00:05<00:06, 30.13it/s]Running modern_bert_finetuned:  21%|██        | 53/250 [00:05<00:05, 34.49it/s]Running modern_bert_finetuned:  24%|██▎       | 59/250 [00:05<00:04, 38.22it/s]Running modern_bert_finetuned:  26%|██▌       | 65/250 [00:05<00:04, 41.45it/s]Running modern_bert_finetuned:  28%|██▊       | 71/250 [00:05<00:04, 43.99it/s]Running modern_bert_finetuned:  31%|███       | 77/250 [00:05<00:03, 46.02it/s]Running modern_bert_finetuned:  33%|███▎      | 83/250 [00:06<00:03, 47.38it/s]Running modern_bert_finetuned:  36%|███▌      | 89/250 [00:06<00:03, 48.44it/s]Running modern_bert_finetuned:  38%|███▊      | 95/250 [00:06<00:03, 49.20it/s]Running modern_bert_finetuned:  40%|████      | 101/250 [00:06<00:02, 49.93it/s]Running modern_bert_finetuned:  43%|████▎     | 107/250 [00:06<00:02, 50.30it/s]Running modern_bert_finetuned:  45%|████▌     | 113/250 [00:06<00:02, 50.51it/s]Running modern_bert_finetuned:  48%|████▊     | 119/250 [00:06<00:02, 50.68it/s]Running modern_bert_finetuned:  50%|█████     | 125/250 [00:06<00:02, 50.98it/s]Running modern_bert_finetuned:  52%|█████▏    | 131/250 [00:06<00:02, 51.23it/s]Running modern_bert_finetuned:  55%|█████▍    | 137/250 [00:07<00:02, 51.30it/s]Running modern_bert_finetuned:  57%|█████▋    | 143/250 [00:07<00:02, 51.29it/s]Running modern_bert_finetuned:  60%|█████▉    | 149/250 [00:07<00:01, 51.25it/s]Running modern_bert_finetuned:  62%|██████▏   | 155/250 [00:07<00:01, 51.36it/s]Running modern_bert_finetuned:  64%|██████▍   | 161/250 [00:07<00:01, 51.54it/s]Running modern_bert_finetuned:  67%|██████▋   | 167/250 [00:07<00:01, 51.38it/s]Running modern_bert_finetuned:  69%|██████▉   | 173/250 [00:07<00:01, 51.41it/s]Running modern_bert_finetuned:  72%|███████▏  | 179/250 [00:07<00:01, 51.50it/s]Running modern_bert_finetuned:  74%|███████▍  | 185/250 [00:08<00:01, 51.69it/s]Running modern_bert_finetuned:  76%|███████▋  | 191/250 [00:08<00:01, 51.53it/s]Running modern_bert_finetuned:  79%|███████▉  | 197/250 [00:08<00:01, 51.59it/s]Running modern_bert_finetuned:  81%|████████  | 203/250 [00:08<00:00, 51.08it/s]Running modern_bert_finetuned:  84%|████████▎ | 209/250 [00:08<00:00, 51.24it/s]Running modern_bert_finetuned:  86%|████████▌ | 215/250 [00:08<00:00, 51.27it/s]Running modern_bert_finetuned:  88%|████████▊ | 221/250 [00:08<00:00, 51.28it/s]Running modern_bert_finetuned:  91%|█████████ | 227/250 [00:08<00:00, 51.01it/s]Running modern_bert_finetuned:  93%|█████████▎| 233/250 [00:08<00:00, 51.20it/s]Running modern_bert_finetuned:  96%|█████████▌| 239/250 [00:09<00:00, 51.30it/s]Running modern_bert_finetuned:  98%|█████████▊| 245/250 [00:09<00:00, 51.53it/s]Running modern_bert_finetuned: 100%|██████████| 250/250 [00:09<00:00, 26.91it/s]
Running xlm_roberta_finetuned:   0%|          | 0/250 [00:00<?, ?it/s]Running xlm_roberta_finetuned:   0%|          | 1/250 [00:00<01:42,  2.44it/s]Running xlm_roberta_finetuned:   4%|▎         | 9/250 [00:00<00:10, 22.06it/s]Running xlm_roberta_finetuned:   7%|▋         | 17/250 [00:00<00:06, 37.31it/s]Running xlm_roberta_finetuned:  10%|█         | 25/250 [00:00<00:04, 48.11it/s]Running xlm_roberta_finetuned:  14%|█▎        | 34/250 [00:00<00:03, 58.00it/s]Running xlm_roberta_finetuned:  17%|█▋        | 42/250 [00:00<00:03, 63.84it/s]Running xlm_roberta_finetuned:  20%|██        | 50/250 [00:01<00:02, 66.75it/s]Running xlm_roberta_finetuned:  23%|██▎       | 58/250 [00:01<00:02, 69.52it/s]Running xlm_roberta_finetuned:  26%|██▋       | 66/250 [00:01<00:02, 70.80it/s]Running xlm_roberta_finetuned:  30%|██▉       | 74/250 [00:01<00:02, 71.79it/s]Running xlm_roberta_finetuned:  33%|███▎      | 82/250 [00:01<00:02, 71.21it/s]Running xlm_roberta_finetuned:  36%|███▌      | 90/250 [00:01<00:02, 71.64it/s]Running xlm_roberta_finetuned:  39%|███▉      | 98/250 [00:01<00:02, 72.48it/s]Running xlm_roberta_finetuned:  42%|████▏     | 106/250 [00:01<00:01, 73.11it/s]Running xlm_roberta_finetuned:  46%|████▌     | 114/250 [00:01<00:01, 72.85it/s]Running xlm_roberta_finetuned:  49%|████▉     | 122/250 [00:02<00:01, 74.18it/s]Running xlm_roberta_finetuned:  52%|█████▏    | 130/250 [00:02<00:01, 74.13it/s]Running xlm_roberta_finetuned:  56%|█████▌    | 139/250 [00:02<00:01, 75.68it/s]Running xlm_roberta_finetuned:  59%|█████▉    | 147/250 [00:02<00:01, 75.21it/s]Running xlm_roberta_finetuned:  62%|██████▏   | 155/250 [00:02<00:01, 75.66it/s]Running xlm_roberta_finetuned:  66%|██████▌   | 164/250 [00:02<00:01, 77.71it/s]Running xlm_roberta_finetuned:  69%|██████▉   | 172/250 [00:02<00:01, 76.84it/s]Running xlm_roberta_finetuned:  72%|███████▏  | 181/250 [00:02<00:00, 77.98it/s]Running xlm_roberta_finetuned:  76%|███████▌  | 190/250 [00:02<00:00, 78.73it/s]Running xlm_roberta_finetuned:  80%|███████▉  | 199/250 [00:03<00:00, 79.05it/s]Running xlm_roberta_finetuned:  83%|████████▎ | 208/250 [00:03<00:00, 79.97it/s]Running xlm_roberta_finetuned:  86%|████████▋ | 216/250 [00:03<00:00, 78.87it/s]Running xlm_roberta_finetuned:  90%|████████▉ | 224/250 [00:03<00:00, 78.39it/s]Running xlm_roberta_finetuned:  93%|█████████▎| 232/250 [00:03<00:00, 78.53it/s]Running xlm_roberta_finetuned:  96%|█████████▋| 241/250 [00:03<00:00, 79.30it/s]Running xlm_roberta_finetuned: 100%|█████████▉| 249/250 [00:03<00:00, 78.46it/s]Running xlm_roberta_finetuned: 100%|██████████| 250/250 [00:03<00:00, 68.32it/s]
